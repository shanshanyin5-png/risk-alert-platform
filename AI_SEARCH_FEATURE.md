# AI智能搜索分析功能

## 📋 功能概述

新增AI智能搜索分析页面，提供以下功能：

### 🔍 核心功能

1. **关键词搜索**
   - 支持标题、风险事项、公司名称搜索
   - 实时过滤和匹配

2. **高级筛选**
   - 风险等级过滤（高/中/低）
   - 公司过滤
   - 时间范围过滤（7/30/90天/全部）

3. **AI智能分析**
   - 总体概况统计
   - 高风险预警
   - 时间趋势分析
   - 公司分布分析

4. **快速操作**
   - 快速关键词按钮
   - 搜索结果分页
   - CSV导出功能

## 📁 文件说明

### 新增文件

1. **public/ai-search.html** - AI搜索页面HTML
   - 响应式布局
   - 美观的UI设计
   - 完整的搜索和筛选界面

2. **public/static/ai-search.js** - 页面交互逻辑
   - 搜索功能实现
   - AI分析生成
   - 结果展示和分页
   - CSV导出

### 修改文件

1. **src/index.tsx**
   - 添加 `/ai-search.html` 路由
   - 配置静态文件服务

2. **vite.config.ts**
   - 配置public目录

## 🚀 使用方法

### 访问页面

```
http://localhost:3000/ai-search.html
```

或在生产环境：
```
https://risk-alert-platform.pages.dev/ai-search.html
```

### 搜索示例

1. **关键词搜索**
   - 输入"停电"搜索所有停电相关风险
   - 输入"巴西CPFL"搜索该公司的风险

2. **组合筛选**
   - 搜索"事故" + 风险等级"高风险"
   - 搜索"延期" + 时间"最近30天"

3. **快速搜索**
   - 点击预设的快速关键词按钮
   - 如：停电、事故、延期等

## 🎯 AI分析功能

### 分析内容

1. **总体概况**
   - 搜索结果总数
   - 风险等级分布
   - 关键统计数据

2. **高风险预警**
   - 高风险数量
   - 主要涉及公司
   - 建议措施

3. **时间趋势**
   - 最近7天新风险数量
   - 趋势判断（上升/平稳）

4. **公司分布**
   - Top 3 风险公司
   - 各公司风险数量

### 分析逻辑

基于规则的智能分析（不依赖付费AI API）：
- 统计分析：计算各类风险数量
- 趋势分析：比较时间分布
- 公司分析：统计公司风险数量
- 智能总结：生成结构化分析报告

## 📊 数据导出

### CSV导出格式

```csv
公司名称,风险等级,标题,风险事项,时间,来源
巴西CPFL公司,高风险,停电事故,大规模停电...,2026-01-14,新闻源
```

### 导出步骤

1. 执行搜索
2. 点击"导出结果"按钮
3. 自动下载CSV文件
4. 文件名格式：`风险搜索结果_YYYY-MM-DD.csv`

## 🎨 界面特点

### 设计亮点

1. **渐变色主题**
   - 紫色渐变导航栏
   - 柔和的配色方案

2. **响应式布局**
   - 支持桌面端和移动端
   - 自适应网格布局

3. **交互动画**
   - 卡片悬停效果
   - 打字机动画（AI分析中）
   - 平滑过渡效果

4. **图标系统**
   - FontAwesome图标
   - 直观的视觉提示

## 🔧 技术实现

### 前端技术栈

- **HTML5** - 语义化标记
- **TailwindCSS** - 实用优先的CSS框架
- **Vanilla JavaScript** - 无依赖的原生JS
- **Axios** - HTTP客户端

### 核心功能实现

1. **搜索逻辑**
   ```javascript
   // 获取所有风险数据
   // 关键词过滤
   // 风险等级过滤
   // 公司过滤
   // 时间范围过滤
   // 按时间倒序排序
   ```

2. **AI分析**
   ```javascript
   // 统计各风险等级数量
   // 计算公司分布
   // 分析时间趋势
   // 生成结构化报告
   ```

3. **分页展示**
   ```javascript
   // 每页10条
   // 动态生成页码
   // 上一页/下一页
   ```

## ⚙️ 配置说明

### 默认配置

```javascript
// 每页显示数量
const PAGE_SIZE = 10

// 最大获取数量
const MAX_RESULTS = 1000

// AI分析延迟（模拟）
const AI_ANALYSIS_DELAY = 2000ms
```

### 自定义配置

可以修改 `/static/ai-search.js` 中的配置：
- 调整页面大小
- 修改时间范围选项
- 添加更多快速关键词

## 🐛 已知问题

### Cloudflare Pages静态文件服务

**问题**：直接serve HTML文件时可能出现500错误

**原因**：Cloudflare Workers环境的静态文件服务限制

**临时方案**：
1. 使用完整URL访问：`/ai-search.html`
2. 或在主页添加链接入口

**永久方案**（待实施）：
- 将HTML内容内联到路由中
- 或使用Cloudflare Pages的原生静态服务

## 🚀 部署注意事项

### 本地环境

```bash
# 构建
npm run build

# 重启
pm2 restart risk-alert-platform

# 访问
http://localhost:3000/ai-search.html
```

### 生产环境

```bash
# 部署
npm run build
npx wrangler pages deploy dist --project-name risk-alert-platform

# 访问
https://risk-alert-platform.pages.dev/ai-search.html
```

### 文件检查

确保以下文件存在于dist目录：
- `ai-search.html`
- `static/ai-search.js`

## 📝 后续优化建议

### 短期

1. **修复静态文件服务**
   - 解决Cloudflare Pages的静态文件serve问题
   - 简化URL访问路径

2. **添加主页入口**
   - 在主页添加"AI搜索"按钮
   - 提供明显的功能入口

3. **优化移动端**
   - 改进移动端布局
   - 优化触控交互

### 中期

1. **真实AI集成**
   - 集成OpenAI API（可选）
   - 更智能的分析和总结

2. **高级搜索**
   - 支持正则表达式
   - 多关键词组合
   - 搜索历史记录

3. **可视化增强**
   - 添加图表展示
   - 时间线视图
   - 地图分布

### 长期

1. **个性化推荐**
   - 基于搜索历史
   - 智能推荐相关风险

2. **协作功能**
   - 分享搜索结果
   - 团队协作分析

3. **API开放**
   - 提供搜索API
   - 支持第三方集成

---

**创建时间**：2026-01-14
**版本**：1.0.0
**状态**：已完成基础功能，待解决静态文件服务问题
