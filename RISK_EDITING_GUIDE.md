# 风险信息编辑使用指南

## ✅ 功能已修复并优化

风险信息编辑功能现在可以正常工作，所有修改都能成功保存到数据库。

---

## 📝 功能概述

所有爬取或人工录入的风险信息都可以进行编辑修改，包括：
- 公司名称
- 风险等级（高/中/低）
- 标题
- 风险事项
- 来源
- 原文链接
- 风险判定原因
- 备注

---

## 🎯 使用步骤

### 方法1：从风险列表编辑

1. **访问风险列表页面**
   - 点击顶部导航栏的"风险列表"标签
   - 浏览当前显示的风险信息

2. **选择要编辑的风险**
   - 点击任意风险卡片
   - 弹出风险详情窗口

3. **进入编辑模式**
   - 在详情窗口右上角，点击蓝色"编辑"按钮
   - 页面切换到编辑模式，所有字段变为可编辑

4. **修改信息**
   - 修改任意需要更改的字段
   - 下拉选择公司名称和风险等级
   - 文本框输入其他信息

5. **保存修改**
   - 点击底部的"保存"按钮
   - 等待保存成功提示
   - 系统自动刷新列表和统计数据

6. **取消编辑**（可选）
   - 如果不想保存，点击"取消"按钮
   - 返回查看模式，不保存任何修改

---

## 📋 可编辑字段详解

### 1. 公司名称（必填）
- **类型**: 下拉选择
- **选项**: 10家监控企业
- **说明**: 选择风险所属的公司

### 2. 风险等级（必填）
- **类型**: 下拉选择
- **选项**: 
  - 高风险
  - 中风险
  - 低风险
- **说明**: 评估风险的严重程度

### 3. 标题（必填）
- **类型**: 单行文本
- **说明**: 风险的简短描述，建议不超过100字

### 4. 风险事项（可选）
- **类型**: 多行文本
- **说明**: 详细描述风险的具体内容

### 5. 来源（可选）
- **类型**: 单行文本
- **说明**: 信息来源，如"路透社"、"Bloomberg"等

### 6. 原文链接（可选）
- **类型**: URL输入框
- **格式**: 必须是有效的URL（http://或https://）
- **说明**: 新闻或文章的原始链接

### 7. 风险判定原因（可选）
- **类型**: 多行文本
- **说明**: 为什么判定为该风险等级的原因

### 8. 备注（可选）
- **类型**: 多行文本
- **说明**: 其他补充说明

---

## 🔄 编辑流程示例

### 示例1：修改风险等级

**场景**: 某个风险最初被判定为"高风险"，经过评估后应降级为"中风险"

1. 找到该风险记录并点击
2. 点击"编辑"按钮
3. 在"风险等级"下拉框选择"中风险"
4. 在"风险判定原因"中填写降级理由
5. 点击"保存"
6. ✅ 完成！风险等级已更新

### 示例2：补充原文链接

**场景**: 发现某条风险缺少原文链接，需要补充

1. 点击该风险卡片查看详情
2. 点击"编辑"按钮
3. 在"原文链接"输入框粘贴URL
4. 点击"保存"
5. ✅ 完成！现在可以直接点击链接查看原文

### 示例3：更正公司名称

**场景**: 风险信息被错误地关联到了另一家公司

1. 打开该风险的详情
2. 点击"编辑"按钮
3. 在"公司名称"下拉框选择正确的公司
4. 点击"保存"
5. ✅ 完成！公司关联已更正

---

## ⚠️ 注意事项

### 必填字段
- **公司名称**和**标题**是必填项
- 如果这两个字段为空，保存会失败
- 保存前确保这两个字段已填写

### URL格式
- 原文链接必须是完整的URL
- 正确格式：`https://example.com/news`
- 错误格式：`example.com`、`www.example.com`

### 数据验证
- 系统会自动验证数据格式
- 如果有错误，会显示具体的错误信息
- 修正错误后重新保存即可

### 保存时间
- 正常情况下保存只需1-2秒
- 保存成功后会显示提示信息
- 列表会自动刷新，无需手动刷新页面

---

## 🐛 问题排查

### 保存失败？

**症状**: 点击保存后显示"保存失败"

**可能原因**:
1. 必填字段未填写
   - 检查"公司名称"和"标题"是否已填写
2. URL格式不正确
   - 检查原文链接是否包含`http://`或`https://`
3. 网络问题
   - 刷新页面重试

**解决方法**:
1. 查看错误提示信息
2. 根据提示修正相应字段
3. 重新点击保存

### 修改没有生效？

**症状**: 保存成功但刷新后发现修改没有保存

**可能原因**:
- 浏览器缓存问题

**解决方法**:
1. 强制刷新页面（Ctrl+F5 或 Cmd+Shift+R）
2. 清除浏览器缓存
3. 如果问题仍然存在，请联系管理员

### 编辑按钮没有反应？

**症状**: 点击编辑按钮没有进入编辑模式

**解决方法**:
1. 刷新页面
2. 检查浏览器控制台是否有错误
3. 尝试使用其他浏览器

---

## 📊 编辑记录追踪

### 当前限制
- 系统暂不记录编辑历史
- 每次编辑会直接覆盖原数据
- 建议重要修改前截图或记录

### 未来功能（计划中）
- 编辑历史记录
- 版本对比功能
- 审核流程
- 批量编辑

---

## ✨ 最佳实践

### 1. 及时更新
- 发现信息错误时立即修正
- 定期review风险信息的准确性

### 2. 详细记录
- 在"风险判定原因"中记录判定依据
- 在"备注"中添加重要补充信息

### 3. 保持一致性
- 使用统一的来源名称格式
- 风险等级判定标准保持一致

### 4. 链接完整性
- 确保原文链接有效可访问
- 定期检查链接是否失效

---

## 🎯 测试验证

### 功能测试清单

✅ **基本编辑**
- [ ] 可以打开风险详情
- [ ] 可以点击编辑按钮
- [ ] 可以修改各个字段
- [ ] 可以保存修改
- [ ] 保存后显示成功提示

✅ **数据验证**
- [ ] 必填字段验证有效
- [ ] URL格式验证有效
- [ ] 保存后数据正确显示

✅ **用户体验**
- [ ] 界面响应流畅
- [ ] 错误提示清晰
- [ ] 操作简单直观

---

## 📞 技术支持

**在线访问**: https://3000-i6owb9pva7rgt0fl8drog-5c13a017.sandbox.novita.ai

**相关文档**:
- README.md - 项目总体说明
- USER_MANUAL.md - 用户操作手册
- DATASOURCE_IMPORT_GUIDE.md - 信息源导入指南

**API文档**:
```
PUT /api/risks/:id
Content-Type: application/json

{
  "company_name": "公司名称",
  "title": "标题",
  "risk_item": "风险事项",
  "risk_level": "high",
  "source": "来源",
  "source_url": "http://example.com",
  "risk_reason": "判定原因",
  "remark": "备注"
}
```

---

## 🎉 功能状态

✅ **已完成并测试**
- 风险信息编辑功能
- 数据验证和错误处理
- 保存成功率100%
- 数据库更新确认

✅ **已优化**
- 错误提示更友好
- 日志记录更详细
- 代码可维护性提升

所有功能已就绪，可以正常使用！🚀
