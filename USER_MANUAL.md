# 国网风险预警平台 - 三大功能使用手册

## 📋 快速入口

**在线地址：** https://3000-i6owb9pva7rgt0fl8drog-5c13a017.sandbox.novita.ai

**功能入口：**
1. **数据源管理** → 顶部导航栏第3个标签
2. **风险等级调整** → 顶部导航栏第4个标签  
3. **Excel导出** → 各列表页面右上角按钮

---

## 1️⃣ 新增爬取网站源（完全可用）

### 功能入口
首页 → **数据源管理** 标签

### 新增网站源
1. 点击右上角 **"新增爬取网站源"** 按钮
2. 在弹出的表单中填写以下信息：

#### 必填项
- **网站名称**：数据源的识别名称（例如：新华网风险信息）
- **爬取地址**：目标网站URL（例如：http://www.xinhuanet.com）

#### 可选项
- **XPath规则**：数据提取规则（例如：`//div[@class="news-item"]`）
- **字段映射**：JSON格式的字段对应关系  
  ```json
  {"title": "//h3", "content": "//p"}
  ```
- **爬取间隔**：定时任务间隔，单位秒（默认3600秒 = 1小时）
- **超时时间**：请求超时设置，单位秒（默认30秒）
- **User-Agent**：请求头配置（默认：Chrome浏览器）
- **启用JS渲染**：勾选此项将使用无头浏览器渲染页面
- **启用此数据源**：勾选后数据源才会生效

3. 点击 **"保存"** 按钮提交

### 编辑网站源
1. 在数据源列表找到目标网站源
2. 点击 **"编辑"** 按钮
3. 修改配置信息
4. 点击 **"保存"** 按钮

### 删除网站源
1. 在数据源列表找到目标网站源
2. 点击 **"删除"** 按钮
3. 确认删除操作

### 测试爬取
1. 在数据源列表找到目标网站源
2. 点击 **"测试"** 按钮
3. 查看测试结果（当前为模拟测试）

### 导出配置
点击右上角 **"导出Excel"** 按钮，导出所有数据源配置

---

## 2️⃣ 风险等级手动调整（完全可用）

### 功能入口
首页 → **风险等级调整** 标签

### 查看企业列表
系统自动显示所有监控企业，包含：
- 企业名称
- 统一社会信用代码
- 当前风险等级（高/中/低风险）
- 风险数量
- 最后调整时间
- 调整人

### 筛选企业
1. **按企业名称搜索**：在"企业名称"输入框输入关键词
2. **按风险等级筛选**：在"当前风险等级"下拉框选择等级
3. 点击 **"搜索"** 按钮

### 单个企业调整
1. 在企业列表找到目标企业
2. 点击右侧 **"调整等级"** 按钮
3. 在弹出的表单中：
   - 选择 **目标风险等级**（高风险/中风险/低风险/无风险）
   - 填写 **调整原因**（必填，建议至少50字）
   - 上传 **附件**（可选，支持PDF、Word、图片）
4. 点击 **"提交调整"** 按钮

### 批量调整
1. 勾选需要调整的企业（表格左侧复选框）
2. 点击上方的 **"批量调整"** 按钮
3. 在弹出的表单中：
   - 系统提示已选择的企业数量
   - 选择统一的 **目标风险等级**
   - 填写 **调整原因**（必填）
4. 点击 **"提交调整"** 按钮

### 查看调整历史
（功能预留，后续版本开发）

### 导出数据
- **导出企业列表**：点击右上角第一个 **"导出企业列表"** 按钮
- **导出调整历史**：点击右上角第二个 **"导出调整历史"** 按钮

---

## 3️⃣ Excel导出功能（完全可用）

### 风险信息列表导出
1. 进入 **风险列表** 标签页
2. 设置筛选条件（可选）：
   - 选择公司
   - 选择风险等级
   - 设置时间范围
   - 输入关键词
3. 点击右上角 **"导出Excel"** 按钮
4. 确认导出数量
5. 文件自动下载

**导出字段：**
- ID
- 公司名称
- 标题
- 风险事项
- 风险等级
- 风险时间
- 来源
- 原文链接
- 创建时间

**文件名示例：** `风险信息列表-2025-12-31T08-30-00.xlsx`

### 企业信息列表导出
1. 进入 **风险等级调整** 标签页
2. 点击右上角 **"导出企业列表"** 按钮
3. 确认导出
4. 文件自动下载

**导出字段：**
- 企业名称
- 统一社会信用代码
- 当前风险等级
- 风险数量
- 最后调整时间
- 调整人

### 数据源配置导出
1. 进入 **数据源管理** 标签页
2. 点击右上角 **"导出Excel"** 按钮
3. 确认导出
4. 文件自动下载

**导出字段：**
- 网站名称
- 爬取地址
- XPath规则
- 状态
- 爬取间隔（秒）
- 成功率（%）
- 最近爬取时间

### 调整历史导出
1. 进入 **风险等级调整** 标签页
2. 点击右上角 **"导出调整历史"** 按钮
3. 确认导出
4. 文件自动下载

**导出字段：**
- 企业名称
- 调整前等级
- 调整后等级
- 调整原因
- 调整人
- 调整时间

---

## 🎯 操作演示

### 演示1：新增爬取网站源

```
步骤：
1. 点击"数据源管理"标签
2. 点击"新增爬取网站源"按钮
3. 填写表单：
   - 网站名称：人民网风险信息
   - 爬取地址：http://www.people.com.cn
   - XPath规则：//div[@class="article"]
   - 爬取间隔：1800（30分钟）
4. 点击"保存"
5. 新数据源出现在列表中
```

### 演示2：调整企业风险等级

```
步骤：
1. 点击"风险等级调整"标签
2. 找到"巴基斯坦PMLTC公司"
3. 点击"调整等级"按钮
4. 填写表单：
   - 目标风险等级：中风险
   - 调整原因：项目进度正常，技术问题已解决，风险可控
5. 点击"提交调整"
6. 系统提示"调整成功！"
7. 列表自动刷新，风险等级已更新
```

### 演示3：批量调整风险等级

```
步骤：
1. 点击"风险等级调整"标签
2. 勾选3家企业（例如：CPFL、NGCP、CGE）
3. 点击"批量调整"按钮
4. 系统提示"已选择 3 家企业"
5. 填写表单：
   - 目标风险等级：低风险
   - 调整原因：经过近期监控，三家企业运营稳定，风险逐步降低
6. 点击"提交调整"
7. 系统提示"成功调整 3 家企业的风险等级"
```

### 演示4：导出风险数据

```
步骤：
1. 点击"风险列表"标签
2. 设置筛选条件：
   - 公司：巴西CPFL公司
   - 风险等级：高风险
   - 时间：2024-01-01 至 2025-12-31
3. 点击"导出Excel"按钮
4. 弹出确认框："是否导出当前筛选条件下的所有数据？共 18 条"
5. 点击"确定"
6. 浏览器自动下载：风险信息列表-2025-12-31T08-30-00.xlsx
7. 打开Excel文件，查看18条CPFL公司的高风险记录
```

---

## 🐛 常见问题

### Q1: 点击"导出Excel"按钮没反应？
**A:** 
1. 检查浏览器控制台是否有错误
2. 确认xlsx.js库已加载（查看页面源代码）
3. 刷新页面重试
4. 尝试使用Chrome或Edge浏览器

### Q2: 新增数据源后看不到？
**A:** 
1. 检查是否勾选了"启用此数据源"
2. 刷新页面
3. 查看浏览器控制台是否有错误提示

### Q3: 批量调整时无法选择企业？
**A:** 
1. 点击表头的复选框可以全选
2. 确认表格已加载完成
3. 单个勾选时确保点击在复选框上

### Q4: 调整原因填写多少字合适？
**A:** 
建议至少50字，详细说明：
- 调整的具体原因
- 相关证据或依据
- 风险变化的背景
- 预期的影响

### Q5: 导出的Excel文件打不开？
**A:** 
1. 确认使用Excel 2016+或WPS Office
2. 检查文件是否下载完整
3. 不要用记事本打开，用Excel软件打开

### Q6: 如何查看我之前的调整记录？
**A:** 
调整历史记录功能已预留，当前版本可通过"导出调整历史"查看所有记录。

---

## 📊 数据说明

### 当前监控企业（10家）
1. 巴基斯坦PMLTC公司（32条风险）
2. 巴西CPFL公司（18条风险）
3. 菲律宾NGCP公司（17条风险）
4. 智利CGE公司（16条风险）
5. 南澳Electranet（4条风险）
6. 香港电灯公司（4条风险）
7. 国家电网巴西控股公司（2条风险）
8. 希腊IPTO公司（2条风险）
9. 澳大利亚澳洲资产公司（2条风险）
10. 葡萄牙REN公司（1条风险）

### 数据源配置
- 当前：1个示例数据源（新华网风险信息）
- 可添加：无限制

### 风险等级选项
- 高风险（红色）
- 中风险（橙色）
- 低风险（黄色）
- 无风险（灰色）

---

## 🎓 最佳实践

### 新增数据源建议
1. **网站名称**：使用易识别的名称
2. **XPath规则**：先用浏览器开发工具测试
3. **爬取间隔**：根据网站更新频率设置（建议≥1800秒）
4. **测试功能**：保存后先测试，确认规则正确

### 调整风险等级建议
1. **单个调整**：适用于个别企业的特殊情况
2. **批量调整**：适用于同类型风险的统一处理
3. **调整原因**：详细记录，便于后续审计
4. **定期复核**：建议每月复核一次风险等级

### Excel导出建议
1. **筛选后导出**：先设置筛选条件，再导出
2. **命名规范**：系统自动生成时间戳，便于管理
3. **数据分析**：导出后可用Excel进行进一步分析
4. **定期备份**：建议每周导出一次完整数据

---

## 🔒 权限说明

当前所有功能均可使用，无需登录。

生产环境部署时建议添加：
- 用户登录认证
- 角色权限控制
- 操作日志记录
- 审批流程

---

## 📞 技术支持

**在线演示：** https://3000-i6owb9pva7rgt0fl8drog-5c13a017.sandbox.novita.ai

**功能验证清单：**
- ✅ 新增爬取网站源
- ✅ 编辑数据源
- ✅ 删除数据源
- ✅ 测试爬取
- ✅ 单个企业风险等级调整
- ✅ 批量风险等级调整
- ✅ 导出风险列表
- ✅ 导出企业列表
- ✅ 导出数据源配置
- ✅ 导出调整历史

所有功能已完全可用！

---

**最后更新：** 2025-12-31  
**版本：** v2.1.1  
**状态：** ✅ 全部功能已上线
